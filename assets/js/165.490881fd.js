(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{581:function(t,s,a){"use strict";a.r(s);var n=a(62),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"错误处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误处理"}},[t._v("#")]),t._v(" 错误处理")]),t._v(" "),a("p",[t._v("错误处理在程序设计中相当重要。")]),t._v(" "),a("p",[t._v("任何有影响力的 Web 应用程序都需要一套完善的错误处理机制，同时考虑类型、频率，或者其他重要的标准对错误进行分类。这样，开发人员才能解决应用程序可能会出现的问题。")]),t._v(" "),a("h2",{attrs:{id:"try-catch-语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#try-catch-语句"}},[t._v("#")]),t._v(" try-catch 语句")]),t._v(" "),a("p",[a("code",[t._v("try-catch")]),t._v(" 语句是 JavaScript 中处理异常的一种标准方式，我们把所有可能会抛出错误的代码都放在 "),a("code",[t._v("try")]),t._v(" 语句块中，然后把那些用于错误处理的代码放在 "),a("code",[t._v("catch")]),t._v(" 块中。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do someing")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 处理错误")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("如果 "),a("code",[t._v("try")]),t._v(" 块中的任何代码发生了错误，就会立即执行 "),a("code",[t._v("catch")]),t._v(" 块中的代码，"),a("code",[t._v("catch")]),t._v(" 块会接收到一个包含错误信息的对象。")]),t._v(" "),a("p",[a("strong",[t._v("与在其他语言中不同的是，即使不使用这个错误对象，也要给它起个名字")]),t._v("。这个对象中包含的实际信息会因浏览器而异，但共同的是有一个保存着错误消息的 "),a("code",[t._v("message")]),t._v(" 属性。ECMA-262 还规定了一个保存错误类型的 "),a("code",[t._v("name")]),t._v(" 属性。")]),t._v(" "),a("h2",{attrs:{id:"finally-子句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#finally-子句"}},[t._v("#")]),t._v(" finally 子句")]),t._v(" "),a("p",[a("code",[t._v("finally")]),t._v(" 子句在 "),a("code",[t._v("try-catch")]),t._v(" 语句中是可选的，但 "),a("code",[t._v("finally")]),t._v(" 子句一经使用，其代码无论如何都会执行。无论 "),a("code",[t._v("try")]),t._v(" 或 "),a("code",[t._v("catch")]),t._v(" 语句块中包含什么代码——甚至 "),a("code",[t._v("return")]),t._v(" 语句，都不能阻止。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("testFinally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NonexistentVariable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" error\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'something'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("另外，如果提供 "),a("code",[t._v("finally")]),t._v(" 子句，则 "),a("code",[t._v("catch")]),t._v(" 子句就成了可选的（catch 或 finally 有一个即可）。")]),t._v(" "),a("h2",{attrs:{id:"错误类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误类型"}},[t._v("#")]),t._v(" 错误类型")]),t._v(" "),a("p",[t._v("CMA-262 定义了下列 7 种错误类型：")]),t._v(" "),a("ul",[a("li",[t._v("Error")]),t._v(" "),a("li",[t._v("EvalError")]),t._v(" "),a("li",[t._v("RangeError")]),t._v(" "),a("li",[t._v("ReferenceError")]),t._v(" "),a("li",[t._v("SyntaxError")]),t._v(" "),a("li",[t._v("TypeError")]),t._v(" "),a("li",[t._v("URIError")])]),t._v(" "),a("p",[t._v("其中，"),a("code",[t._v("Error")]),t._v(" 是基类型，其他错误类型都继承自该类型。"),a("code",[t._v("Error")]),t._v(" 类型的错误很少见，如果有也是浏览器抛出的，这个基类型的主要目的是供开发人员抛出自定义错误。")]),t._v(" "),a("p",[a("code",[t._v("EvalError")]),t._v(" 类型的错误会在使用 "),a("code",[t._v("eval()")]),t._v(" 函数而发生异常时被抛出：如果没有把 "),a("code",[t._v("eval()")]),t._v(" 当成函数调用，就会抛出错误。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//抛出EvalError")]),t._v("\neval "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" foo "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//抛出EvalError")]),t._v("\n")])])]),a("p",[a("code",[t._v("RangeError")]),t._v(" 类型的错误会在数值超出相应范围时触发。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" items1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//抛出RangeError")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" items2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAX_VALUE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//抛出RangeError")]),t._v("\n")])])]),a("p",[a("code",[t._v("ReferenceError")]),t._v(' 在找不到对象的情况下（"object expected" 浏览器错误）便会发生。')]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在 x 并未声明的情况下抛出 ReferenceError")]),t._v("\n")])])]),a("p",[a("code",[t._v("SyntaxError")]),t._v(" 在把语法错误的 JavaScript 字符串传入 "),a("code",[t._v("eval()")]),t._v(" 函数时就会出现。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a ++ b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//抛出SyntaxError")]),t._v("\n")])])]),a("p",[a("code",[t._v("TypeError")]),t._v(" 类型在 JavaScript 中会经常用到，在变量中保存着意外的类型时，或者在访问不存在的方法时，都会导致这种错误。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" o "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("code",[t._v("URIError")]),t._v(" 错误在使用 "),a("code",[t._v("encodeURI()")]),t._v(" 或 "),a("code",[t._v("decodeURI()")]),t._v(" 时，而 URI 格式不正确时，就会导致。")]),t._v(" "),a("p",[t._v("要想知道错误的类型，可以在 "),a("code",[t._v("try-catch")]),t._v(" 语句的 "),a("code",[t._v("catch")]),t._v(" 语句中使用 "),a("code",[t._v("instanceof")]),t._v(" 操作符。")]),t._v(" "),a("h2",{attrs:{id:"合理使用-try-catch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合理使用-try-catch"}},[t._v("#")]),t._v(" 合理使用 try-catch")]),t._v(" "),a("p",[t._v("当 "),a("code",[t._v("try-catch")]),t._v(" 语句中发生错误时，浏览器会认为错误已经被处理了，因而不会记录或报告错误，以能够让我们实现自己的错误处理机制。")]),t._v(" "),a("p",[t._v("使用 "),a("code",[t._v("try-catch")]),t._v(" 最适合处理那些我们无法控制的错误。")]),t._v(" "),a("p",[t._v("比如，我们在调用第三方库的方法时，如果有意无意地抛出一些错误，由于我们不能修改这个库的源代码，所以大可将对该函数的调用放在 "),a("code",[t._v("try-catch")]),t._v(" 语句当中，这样就可以恰当地处理它们。")]),t._v(" "),a("p",[t._v("在明明白白地知道自己的代码会发生错误时，再使用 "),a("code",[t._v("try-catch")]),t._v(" 语句就不需要这样多此一举了。")]),t._v(" "),a("h2",{attrs:{id:"抛出错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#抛出错误"}},[t._v("#")]),t._v(" 抛出错误")]),t._v(" "),a("p",[t._v("与 "),a("code",[t._v("try-catch")]),t._v(" 语句相配的还有一个 "),a("code",[t._v("throw")]),t._v(" 操作符，用于随时抛出自定义错误。抛出错误时，必须要给 "),a("code",[t._v("throw")]),t._v(" 操作符指定一个值，这个值是什么类型，没有要求。")]),t._v(" "),a("p",[t._v("在遇到 "),a("code",[t._v("throw")]),t._v(" 操作符时，代码会立即停止执行。仅当有 "),a("code",[t._v("try-catch")]),t._v(" 语句捕获到被抛出的值时，代码才会继续执行。")]),t._v(" "),a("p",[t._v("通过使用某种内置错误类型，可以更真实地模拟浏览器错误。每种错误类型的构造函数接收一个参数，即实际的错误消息。")]),t._v(" "),a("p",[t._v("在创建自定义错误消息时最常用的错误类型是 "),a("code",[t._v("Error")]),t._v("、"),a("code",[t._v("RangeError")]),t._v("、"),a("code",[t._v("ReferenceError")]),t._v(" 和 "),a("code",[t._v("TypeError")]),t._v("。")]),t._v(" "),a("p",[t._v("另外，利用原型链还可以通过继承 "),a("code",[t._v("Error")]),t._v(" 来创建自定义错误类型。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("CustomError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CustomError'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" message\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Error message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("浏览器对待继承自 "),a("code",[t._v("Error")]),t._v(" 的自定义错误类型，就像对待其他错误类型一样。如果要捕获自己抛出的错误并且把它与浏览器错误区别对待的话，创建自定义错误是很有用的。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("ul",[a("li",[t._v("通常，应该在出现某种特定的已知错误条件，导致函数无法正常执行时抛出错误。")]),t._v(" "),a("li",[t._v("捕获错误的目的在于避免浏览器以默认方式处理它们；而抛出错误的目的在于提供错误发生具体原因的消息。")])])]),t._v(" "),a("h2",{attrs:{id:"错误-error-事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误-error-事件"}},[t._v("#")]),t._v(" 错误（error）事件")]),t._v(" "),a("p",[t._v("任何没有通过 "),a("code",[t._v("try-catch")]),t._v(" 处理的错误都会触发 "),a("code",[t._v("window")]),t._v(" 对象的 "),a("code",[t._v("error")]),t._v(" 事件。"),a("code",[t._v("onerror")]),t._v(" 事件处理程序都不会创建 "),a("code",[t._v("event")]),t._v(" 对但它可以接收三个参数：错误消息、错误所在的 URL 和行号。")]),t._v(" "),a("p",[t._v("只要发生错误，无论是不是浏览器生成的，都会触发 "),a("code",[t._v("error")]),t._v(" 事件并执行这个事件处理程序。然后，浏览器像往常一样显示出错误消息。如果在事件处理程序中返回 "),a("code",[t._v("false")]),t._v("，就可以阻止浏览器报告错误的默认行为。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" line")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("图像也支持 "),a("code",[t._v("error")]),t._v(" 事件，只要图像的 "),a("code",[t._v("src")]),t._v(" 特性中的 URL 不能返回可以被识别的图像格式，就会触发 "),a("code",[t._v("error")]),t._v(" 事件。此时的 "),a("code",[t._v("error")]),t._v(" 事件遵循 DOM 格式，会返回一个以图像为目标的 "),a("code",[t._v("event")]),t._v(" 对象。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nimage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'doraemon.png'")]),t._v("\n")])])]),a("p",[t._v("当加载图像失败时就会执行错误处理程序。需要注意的是，发生 "),a("code",[t._v("error")]),t._v(" 事件时，图像下载过程已经结束，也就是说不能再重新下载了。")]),t._v(" "),a("h2",{attrs:{id:"常见的错误类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见的错误类型"}},[t._v("#")]),t._v(" 常见的错误类型")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("类型转换错误")])])]),t._v(" "),a("p",[t._v("类型转换错误发生在使用某个操作符，或者使用其他可能会自动转换值的数据类型的语言结构时。")]),t._v(" "),a("p",[t._v("容易发生类型转换错误的另一个地方，就是流控制语句。像 "),a("code",[t._v("if")]),t._v(" 之类的语句在确定下一步操作之前，会自动把任何值转换成布尔值。尤其是 "),a("code",[t._v("if")]),t._v(" 语句，如果使用不当，最容易出错。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" str2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" str3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" str2\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 绝对不要这样，建议使用：'string' === typeof str3")]),t._v("\n    result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" str3\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[a("strong",[t._v("数据类型错误")])])]),t._v(" "),a("p",[t._v("JavaScript 是松散类型的，也就是说，在使用变量和函数参数之前，不会对它们进行比较以确保它们的数据类型正确。")]),t._v(" "),a("p",[t._v("比如，在一些函数中，对传入的参数没有进行类型检测，然后调用数组具有的一些方法做一些业务上的处理。当传入的参数是字符串时，那么对其调用数组特有的方法就会报错。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("通信错误")])])]),t._v(" "),a("p",[t._v("最常见的问题是在将数据发送给服务器之前，没有使用 "),a("code",[t._v("encodeURIComponent()")]),t._v(" 对数据进行编码，对于查询字符串，应该记住必须要使用 "),a("code",[t._v("encodeURIComponent()")]),t._v(" 方法。")]),t._v(" "),a("h2",{attrs:{id:"调试技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调试技术"}},[t._v("#")]),t._v(" 调试技术")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("将消息记录到当前页面")])])]),t._v(" "),a("p",[t._v("在页面中开辟一小块区域，用以显示消息。这个区域通常是一个元素，而该元素可以总是出现在页面中，但仅用于调试目的。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" console "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'debuginfo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'debuginfo'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("background "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#dedede'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("border "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1px solid silver'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("padding "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5px'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'400px'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("position "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'absolute'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("right "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0px'")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0px'")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<p>'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" message "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'</p>'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这种技术在不支持 JavaScript 控制台的 IE7 及更早版本或其他浏览器中十分有用，它先检测是否已经存在调试元素，如果没有则会新创建一个 "),a("code",[t._v("<div>")]),t._v(" 元素，并为该元素应用一些样式，以便与页面中的其他元素区别开。然后，又使用 "),a("code",[t._v("innerHTML")]),t._v(" 将消息写入到这个 "),a("code",[t._v("<div>")]),t._v(" 元素中。结果就是页面中会有一小块区域显示错误消息。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("将消息记录到控制台")])])]),t._v(" "),a("p",[t._v("通过 "),a("code",[t._v("console")]),t._v(" 对象向 JavaScript 控制台中写入消息，这个对象具有下列方法：")]),t._v(" "),a("ul",[a("li",[t._v("error(message)：将错误消息记录到控制台。")]),t._v(" "),a("li",[t._v("info(message)：将信息性消息记录到控制台。")]),t._v(" "),a("li",[t._v("log(message)：将一般消息记录到控制台。")]),t._v(" "),a("li",[t._v("warn(message)：将警告消息记录到控制台。")])]),t._v(" "),a("p",[t._v("错误消息带有红色图标，而警告消息带有黄色图标。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("抛出错误")])])]),t._v(" "),a("p",[t._v("抛出错误也是一种调试代码的好办法，自定义的错误通常都使用 "),a("code",[t._v("assert()")]),t._v(" 函数抛出。这个函数接受两个参数，一个是求值结果应该为 "),a("code",[t._v("true")]),t._v(" 的条件，另一个是条件为 "),a("code",[t._v("false")]),t._v(" 时要抛出的错误。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("condition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("conditin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("divide")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dividend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" divisor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" dividend "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'number'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" divisor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'number'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'divide(): Both arguments must be numbers.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" dividend "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" divisor\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("可见，使用 "),a("code",[t._v("assert()")]),t._v(" 函数可以减少抛出错误所需的代码量，而且也比前面的代码更容易看懂。")]),t._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[t._v("JavaScript 高级程序设计(第 3 版)")])])])}),[],!1,null,null,null);s.default=r.exports}}]);